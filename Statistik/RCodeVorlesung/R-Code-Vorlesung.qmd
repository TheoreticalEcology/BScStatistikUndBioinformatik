---
title: "R Code der Vorlesung BSc Statistik und Bioinformatik"
author: "Florian Hartig"
abstract: "Dieses Dokument fasst den in der Vorlesung live vorgeführten R Code zusammen. Das pdf wird im Laufe der Vorlesung ergänzt. Wichtig: es handelt sich hier um eine Sammlung von Code, nicht um ein Lehrbuch. Insbesondere kann dieses Dokument die in der Vorlesung gegebene mündliche Erklärung der Motivation / Outputs nicht ersetzen. Bezüglich letztere verweise ich auf Ihre Mitschriften, die Vorlesungsunterlagen und das Skript."
format: 
  html:
    toc: true
editor_options: 
  chunk_output_type: console
---

```{r, echo=F}
set.seed(123)
```


# Woche 1 - Univariate deskriptive Statistik

## Einführung R

```{r}
2+2
sqrt(3)
(2+2)*2

x = 5

var1 = c(1,2,3,4)

mean(var1)
sd(var1)

# Das ist ein Kommentar

quantile(var1)

var2 = factor(c("rot", "gelb", "gruen", "blau"))

class(var1)
class(var2)

dat = data.frame(var1 = var1, var2 = var2)

# Zugriff über $
dat$var1

plot(var1)
barplot(var1)
```

## Ihre Daten

Für des Einlesen der echten Daten

```{r}
daten <- read.csv("../Daten/Biostatistik Umfrage 2023.csv", stringsAsFactors = T, na.strings = c(""))

daten$Zeitstempel = NULL
colnames(daten) = c("Einwohner", "Distanz", "Körpergröße", "Körpergewicht", "Geschlecht", "Händigkeit", "Verkehrsmittel",  "Getränk", "Vegetarier","Studium", "Zukunft", "CO2Steuer", "Parkgebuehr")
summary(daten)

daten <- missRanger::missRanger(daten, pmm.k = 3, verbose = 0)
summary(daten)
```


Code für das Einlesen der randomisierten Daten, die als csv File auf GRIPS verfügbar sind (natürlich müssten Sie den Pfad so anpassen, dass es für Ihren Computer passt).

```{r,eval=FALSE}
daten = read.csv(file = "./Biostatistik Umfrage 2023 Randomisiert.csv")
```

## Kategorisch ungeordnet


```{r}
x = table(daten$Getränk)
barplot(x, las = 2)
pie(x)

x = table(daten$Verkehrsmittel)
x
barplot(x, las = 2)

x = table(daten$Geschlecht)
x
barplot(x, las = 2, col = c("red", "blue"))

x = table(daten$Händigkeit)
x
barplot(x, las = 2)

x = table(daten$Vegetarier)
x
barplot(x, las = 2)
```

## numerische Variablen

```{r}
hist(daten$Distanz, breaks = 100)
hist(log10(daten$Distanz + 1), breaks = 100)

mean(daten$Distanz)
median(daten$Distanz)
var(daten$Distanz)
sd(daten$Distanz)
quantile(daten$Distanz)
boxplot(daten$Distanz, ylim = c(0,1000))

x = daten$Einwohner
summary(x)
hist(x, breaks = 100)
boxplot(x, ylim = c(0,1000000))

x = daten$Körpergröße
summary(x)
hist(x, breaks = 100)
boxplot(x)

x = daten$Körpergewicht
summary(x)
hist(x, breaks = 100)
boxplot(x)
```

## kategorisch geordnet / ordinal

Können wir entweder kategorisch oder numerisch behandeln

```{r}
x = table(daten$Parkgebuehr)
barplot(x)
mean(daten$Parkgebuehr)

x = table(daten$Studium)
barplot(x)

x = table(daten$Zukunft)
barplot(x)

x = table(daten$CO2Steuer)
barplot(x)

```

# Woche 2 - Korrelation und Assoziation

## kat \~ kat


```{r}
x = table(daten$Geschlecht, daten$Vegetarier)
x
barplot(t(x), beside = T)
barplot(x, beside = F)

mosaicplot(x)

x = table(daten$Geschlecht, daten$Getränk)
x
barplot(x, beside = T, las = 2)

x = table(daten$Geschlecht, daten$Verkehrsmittel)
x
barplot(x, beside = T, las = 2)
mosaicplot(t(x))


x = table(daten$Geschlecht, daten$Studium)
x
barplot(t(x), beside = T, las = 2)
mosaicplot(x)

```


## kat \~ num

```{r}
boxplot(Körpergewicht ~ Geschlecht, data = daten)
boxplot(Körpergröße ~ Geschlecht, data = daten)
boxplot(Körpergewicht ~ Getränk, data = daten)
boxplot(Körpergewicht ~ Vegetarier, data = daten)
boxplot(Körpergröße ~ Verkehrsmittel, data = daten)

boxplot(CO2Steuer ~ Verkehrsmittel, data = daten)
boxplot(Parkgebuehr ~ Verkehrsmittel, data = daten)
```


## num \~ num



```{r}
plot(daten$Körpergröße, daten$Körpergewicht)

cor(daten$Körpergröße, daten$Körpergewicht)
cor(daten$Körpergröße, daten$Körpergewicht, method = "spearman")

sel = daten$Körpergröße > 150
cor(daten$Körpergröße[sel], daten$Körpergewicht[sel])
cor(daten$Körpergröße[sel], daten$Körpergewicht[sel], method = "spearman")


plot(log10(daten$Einwohner+1), daten$Körpergröße)
cor(log10(daten$Einwohner+1), daten$Körpergröße)
cor(log10(daten$Einwohner+1), daten$Körpergröße, method = "spearman")

plot(log10(daten$Einwohner+1), daten$Körpergewicht)
cor(log10(daten$Einwohner+1), daten$Körpergewicht)
cor(log10(daten$Einwohner+1), daten$Körpergewicht, method = "spearman")

plot(daten$Einwohner, daten$Körpergewicht)
cor(daten$Einwohner, daten$Körpergewicht)
cor(daten$Einwohner, daten$Körpergewicht, method = "spearman")

# Motivation p-Wert
plot(log10(daten$Einwohner+1), daten$Körpergewicht)
cor(log10(daten$Einwohner+1), daten$Körpergewicht, method = "spearman")
cor(rnorm(80), rnorm(80), method = "spearman")
cor.test(log10(daten$Einwohner+1), daten$Körpergewicht, method = "spearman")
```




